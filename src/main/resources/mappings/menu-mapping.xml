<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MenuDAO">

	<insert id="insertPizza"
		parameterType="com.damino.web.admin.menu.PizzaVO">
		INSERT ALL
			INTO pizza (p_code, p_name, p_type, p_size, p_price, p_dough, p_image, seq)
			VALUES('P'||LPAD(pizza_seq.nextval, 3, '0'), #{p_name}, #{p_type}, #{p_size}, #{p_price}, #{p_dough}, #{p_image}, (select nvl(max(seq), 0)+1 from pizza))
			INTO p_nutrients (p_nutrients_code, gross_weight, onetime_basis, onetime_weight, kcal, protein, fat, natrium, sugars, p_code)
			VALUES('NP'||LPAD(p_nutrients_seq.nextval, 3, '0'), #{gross_weight}, #{onetime_basis}, #{onetime_weight}, #{kcal}, #{protein}, #{fat}, #{natrium}, #{sugars}, 'P'||LPAD(pizza_seq.nextval, 3, '0'))
		SELECT * FROM DUAL
	</insert>
	
	<insert id="insertSide"
		parameterType="com.damino.web.admin.menu.SideVO">
		INSERT ALL
			INTO side (s_code, s_name, s_price, s_image, seq)
			VALUES('S'||LPAD(side_seq.nextval, 3, '0'), #{s_name}, #{s_price}, #{s_image}, (select nvl(max(seq), 0)+1 from side))
			INTO s_nutrients (s_nutrients_code, gross_weight, kcal, protein, fat, natrium, sugars, s_code)
			VALUES('NS'||LPAD(s_nutrients_seq.nextval, 3, '0'), #{gross_weight}, #{kcal}, #{protein}, #{fat}, #{natrium}, #{sugars}, 'S'||LPAD(side_seq.nextval, 3, '0'))
		SELECT * FROM DUAL
	</insert>
	
	<insert id="insertDrinkEtc"
		parameterType="com.damino.web.admin.menu.DrinkEtcVO">
		INSERT INTO drink_etc (d_code, d_name, d_price, d_image, seq)
		VALUES ('D'||LPAD(drink_etc_seq.nextval, 3, '0'), #{d_name}, #{d_price}, #{d_image}, (select nvl(max(seq), 0)+1 from drink_etc))
	</insert>
	
	<insert id="insertTopping"
		parameterType="com.damino.web.admin.menu.ToppingVO">
		INSERT INTO topping (t_code, t_name, t_type, t_price, t_image, seq)
		VALUES ('T'||LPAD(topping_seq.nextval, 3, '0'), #{t_name}, #{t_type}, #{t_price}, #{t_image}, (select nvl(max(seq), 0)+1 from topping))
	</insert>

	<select id="getPizzaList" 
		resultType="com.damino.web.admin.menu.PizzaVO">
		SELECT seq, P_CODE, P_NAME, P_TYPE, P_PRICE
		FROM PIZZA
	</select>

	<select id="getNutrients"
		resultType="com.damino.web.admin.menu.PizzaVO">
		SELECT *
		FROM p_nutrients
	</select>
	
	<select id="getToppingList"
		resultType="com.damino.web.admin.menu.ToppingVO">
		SELECT seq, t_code, t_name, t_type, t_price
		FROM topping
	</select>
		
	<select id="getSideList"	
		resultType="com.damino.web.admin.menu.SideVO">
		SELECT seq, s_code, s_name, s_price
		FROM side
	</select>

	<select id="getDrinkEtcList"	
		resultType="com.damino.web.admin.menu.DrinkEtcVO">
		SELECT seq, d_code, d_name, d_price
		FROM drink_Etc
	</select>

		
	<select id="getPizza" 
		resultType="com.damino.web.admin.menu.PizzaVO">
        
        SELECT * FROM pizza 
        where seq=#{seq}
        
                    		
<!--  		SELECT pizza.p_code, pizza.p_name, pizza.p_type, pizza.p_size, pizza.p_price, pizza.p_dough, pizza.p_image, pizza.seq, p_nutrients.p_nutrients_code,  p_nutrients.gross_weight,  p_nutrients.onetime_basis,  p_nutrients.onetime_weight, p_nutrients.kcal,  p_nutrients.protein,  p_nutrients.fat,  p_nutrients.natrium,  p_nutrients.sugars,  p_nutrients.p_code
		FROM pizza, p_nutrients
		WHERE pizza.p_code = p_nutrients.p_code  -->
		
		
	</select>
	
</mapper>
