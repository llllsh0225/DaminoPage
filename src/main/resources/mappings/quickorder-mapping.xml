<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="QuickOrderDAO">
	
	<select id="getQuickOrderGoodsList" parameterType="String" resultType="com.damino.web.user.quickorder.QuickOrderGoodsVO">
		SELECT * FROM quickorder_goods
		WHERE userid = #{userid}
	</select>
	
	<select id="getQuickOrderAddressList" parameterType="String" resultType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		SELECT * FROM quickorder_address
		WHERE userid = #{userid}
	</select>
	
	<select id="getGoodsNextRowSeq" parameterType="String" resultType="Integer">
		SELECT MAX(rowseq) + 1 FROM quickorder_goods
		WHERE userid = #{userid}
	</select>
	
	<select id="getAddressNextRowSeq" parameterType="String" resultType="Integer">
		SELECT MAX(rowseq) + 1 FROM quickorder_address
		WHERE userid = #{userid}
	</select>
	
	<select id="getDefaultDeliveryAddress" parameterType="String" resultType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		SELECT * FROM quickorder_address
		WHERE default_yn = 'Y' AND userid = #{userid}
	</select>
	
	<select id="getPizzaNames" resultType="com.damino.web.admin.menu.PizzaVO">
		SELECT p_name FROM pizza
	</select>

	<select id="getPizzaDough" parameterType="String" resultType="com.damino.web.admin.menu.PizzaVO">
		SELECT p_dough FROM pizza WHERE p_name = #{p_name}
	</select>
	
	<select id="getSideNames" resultType="com.damino.web.admin.menu.SideVO">
		SELECT s_name FROM side
	</select>
	
	<select id="getDrinkNames" resultType="com.damino.web.admin.menu.DrinkEtcVO">
		SELECT d_name FROM drink_etc
	</select>
	
	<select id="getPizzaLPrice" parameterType="String" resultType="Integer">
		SELECT p_price_l FROM pizza WHERE p_name = #{goodsName}
	</select>
	
	<select id="getPizzaMPrice" parameterType="String" resultType="Integer">
		SELECT p_price_m FROM pizza WHERE p_name = #{goodsName}
	</select>
	
	<select id="getDoughPrice" parameterType="String" resultType="Integer">
		SELECT price FROM dough WHERE dough_name = #{dough}
	</select>
	
	<select id="getSidePrice" parameterType="String" resultType="Integer">
		SELECT s_price FROM side WHERE s_name = #{goodsName}
	</select>
	
	<select id="getDrinkEtcPrice" parameterType="String" resultType="Integer">
		SELECT d_price FROM drink_etc WHERE d_name = #{goodsName}
	</select>

	<insert id="insertQuickOrderGoods" parameterType="com.damino.web.user.quickorder.QuickOrderGoodsVO">
		INSERT INTO quickorder_goods (seq, quick_goods, quick_qty, quick_price, rowseq, userid)
		VALUES (quickorder_goods_seq.nextval, #{quick_goods}, #{quick_qty}, #{quick_price}, #{rowseq}, #{userid})
	</insert>
	
	<delete id="deleteQuickOrderGoods" parameterType="com.damino.web.user.quickorder.QuickOrderGoodsVO">
		DELETE FROM quickorder_goods
		WHERE userid = #{userid} AND rowseq = #{rowseq}
	</delete>
	
	<select id="getStorePhone" parameterType="String" resultType="String">
		SELECT storephone FROM daminostoreinfo WHERE storename = #{storeName}
	</select>
	
	<insert id="insertQuickOrderAddress" parameterType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		INSERT INTO quickorder_address (seq, address, storename, storephone, rowseq, userid)
		VALUES (quickorder_address_seq.nextval, #{address}, #{storename}, #{storephone}, #{rowseq}, #{userid})
	</insert>
	
	<update id="setDefaultDeliveryAddress" parameterType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		UPDATE quickorder_address SET default_yn = 'Y'
		WHERE userid = #{userid} AND rowseq = #{rowseq}
	</update>
	
	<update id="releaseDefaultDeliveryAddress" parameterType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		UPDATE quickorder_address SET default_yn = 'N'
		WHERE NOT rowseq IN #{rowseq} AND userid = #{userid}
	</update>
	
	<delete id="deleteQuickOrderAddress" parameterType="com.damino.web.user.quickorder.QuickOrderAddressVO">
		DELETE FROM quickorder_address
		WHERE userid = #{userid} AND rowseq = #{rowseq}
	</delete>
	
	<select id="getBusinessHour" parameterType="String" resultType="com.damino.web.admin.market.MarketVO">
		SELECT opentime, endtime FROM daminostoreinfo
		WHERE storename = #{storename}
	</select>
	
</mapper>
