<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UserLevelDAO">

	<!-- 지난 3개월 간의 주문 건수를 카운트 -->
	<select id="getUsersOrderCnt" parameterType="String" resultType="Integer">
		<![CDATA[
		SELECT COUNT(*) FROM order_list
		WHERE orderdate >= ADD_MONTHS(TRUNC(sysdate,'MM'), -2)
		AND userid = #{userid}
		]]>
	</select>

	<!-- 올해 1월 1일부터 현재까지의 주문액수를 카운트 -->
	<select id="getUsersPayCnt" parameterType="String" resultType="Integer">
		<![CDATA[
		SELECT SUM(price) FROM order_list
	    WHERE orderdate >= TRUNC(sysdate, 'yyyy')
	    AND userid = #{userid}
		]]>
	</select>
</mapper>
